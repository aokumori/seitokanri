<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Hồ sơ học sinh</title>
  <link rel="stylesheet" href="css/main.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>

<body>
  <div id="particles-js"></div>

  <div class="navbar">
    <div class="nav-content">
      <h2>Hồ sơ học sinh</h2>
      <nav>
        <a href="dashboard.html" class="nav-item">
            <i class="fa-solid fa-home"></i> Trang chủ
        </a>
        <a href="classes.html" class="nav-item">
            <i class="fa-solid fa-chalkboard"></i> Lớp học
        </a>
        <a href="activities.html" class="nav-item">
            <i class="fa-solid fa-chart-line"></i> Hoạt động
        </a>
        <a href="#" id="btn-logout" class="nav-item">
            <i class="fa-solid fa-right-from-bracket"></i> Đăng xuất
        </a>
      </nav>
    </div>
  </div>

  <div class="content">
    <div class="main-content">
      <!-- Student Detail View -->
      <div id="student-detail-view">
        <header class="page-header">
          <div class="header-left">
            <button id="btn-back-to-class" class="btn-secondary">
              <i class="fa-solid fa-arrow-left"></i> Quay lại
            </button>
            <h1 id="student-detail-title">Chi tiết học sinh</h1>
          </div>
        </header>

        <div class="student-detail-container">
          <!-- Student Basic Info -->
          <div class="student-basic-info glass">
            <div class="student-photo-section">
              <div id="student-photo" class="student-detail-photo">
                <!-- Photo will be loaded here -->
              </div>
              <h2 id="student-name">Tên học sinh</h2>
              <p id="student-code">Mã HS: </p>
            </div>
            
            <div class="student-info-section">
              <h3>Thông tin cơ bản</h3>
              <div class="info-grid">
                <div class="info-item">
                  <strong>Ngày sinh:</strong>
                  <span id="student-birthdate">-</span>
                </div>
                <div class="info-item">
                  <strong>Giới tính:</strong>
                  <span id="student-gender">-</span>
                </div>
                <div class="info-item">
                  <strong>SĐT liên hệ:</strong>
                  <span id="student-phone">-</span>
                </div>
                <div class="info-item">
                  <strong>Email:</strong>
                  <span id="student-email">-</span>
                </div>
                <div class="info-item">
                  <strong>Lớp:</strong>
                  <span id="student-class">-</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Tabs for different sections -->
          <div class="tabs-container">
            <div class="tabs">
              <button class="tab-btn active" data-tab="achievement">Thành tích</button>
              <button class="tab-btn" data-tab="conduct">Hạnh kiểm</button>
              <button class="tab-btn" data-tab="scores">Điểm số</button>
              <button class="tab-btn" data-tab="notes">Ghi chú</button>
            </div>
            
            <div class="tab-content">
              <!-- Achievement Tab -->
              <div id="achievement-tab" class="tab-pane active">
                <div class="section-header">
                  <h3>Thành tích học tập (Thêm điểm ở đây)</h3>
                  <button class="btn-primary btn-small" id="btn-add-achievement">
                    <i class="fa-solid fa-plus"></i> Thêm thành tích/Điểm
                  </button>
                </div>
                <div id="achievement-list">
                  <!-- Achievement list will be loaded here -->
                  <div class="no-data">Chưa có thành tích nào</div>
                </div>
              </div>
              
              <!-- Conduct Tab -->
              <div id="conduct-tab" class="tab-pane">
                <div class="section-header">
                  <h3>Hạnh kiểm</h3>
                  <button class="btn-primary btn-small" id="btn-add-conduct">
                    <i class="fa-solid fa-plus"></i> Thêm đánh giá
                  </button>
                </div>
                <div id="conduct-list">
                  <!-- Conduct list will be loaded here -->
                  <div class="no-data">Chưa có đánh giá hạnh kiểm</div>
                </div>
              </div>
              
              <!-- Scores Tab -->
              <div id="scores-tab" class="tab-pane">
                <div class="section-header">
                  <h3>Điểm số (Tự động từ Thành tích)</h3>
                  <!-- KHÔNG CÓ NÚT THÊM Ở ĐÂY - ĐIỂM ĐƯỢC THÊM Ở TAB THÀNH TÍCH -->
                </div>
                
                <!-- Score summary -->
                <div class="score-summary glass">
                  <h4>Tổng kết học kỳ</h4>
                  <div class="summary-grid">
                    <div class="summary-item">
                      <strong>Điểm TB:</strong>
                      <span id="average-score">-</span>
                    </div>
                    <div class="summary-item">
                      <strong>Học lực:</strong>
                      <span id="academic-rank">-</span>
                    </div>
                    <div class="summary-item">
                      <strong>Xếp loại:</strong>
                      <span id="classification">-</span>
                    </div>
                  </div>
                </div>
                
                <!-- Score subjects -->
                <div class="score-subjects">
                  <h4>Điểm theo môn</h4>
                  <div id="subject-scores">
                    <!-- Subject scores will be loaded here -->
                    <div class="no-data">Chưa có điểm số nào</div>
                  </div>
                </div>

                <!-- Charts Section -->
                <div class="charts-section glass" style="margin-top:30px;padding:25px;border-radius:15px;">
                  <h4 style="color:#2c5530;">Biểu đồ thống kê</h4>
                  <br>
                  <!-- Chart Type Buttons -->
                  <div style="display:flex;gap:10px;margin-bottom:20px;flex-wrap:wrap;">
                    <button class="btn-small chart-type-btn active" data-chart="line" type="button">
                      <i class="fa-solid fa-chart-line"></i> Đường
                    </button>
                    <button class="btn-small chart-type-btn" data-chart="score-pie" type="button">
                      <i class="fa-solid fa-chart-pie"></i> Tròn
                    </button>
                    <button class="btn-small chart-type-btn" data-chart="score-bar" type="button">
                      <i class="fa-solid fa-chart-column"></i> Cột
                    </button>
                  </div>
                  
                  <!-- Line Chart Container -->
                  <div id="line-chart-container" style="margin-bottom:20px;">
                    <canvas id="lineChart" style="max-height:300px;"></canvas>
                  </div>
                  
                  <!-- Score Distribution Chart Container -->
                  <div id="score-dist-chart-container" style="display:none;margin-bottom:20px;">
                    <!-- Legend -->
                    <div style="display:flex;gap:20px;margin-bottom:15px;flex-wrap:wrap;justify-content:center;">
                      <div style="display:flex;align-items:center;gap:8px;">
                        <div style="width:16px;height:16px;background:#d32f2f;border-radius:2px;"></div>
                        <span style="color:#2c5530;font-size:14px;">Yếu (<5)</span>
                      </div>
                      <div style="display:flex;align-items:center;gap:8px;">
                        <div style="width:16px;height:16px;background:#ffa726;border-radius:2px;"></div>
                        <span style="color:#2c5530;font-size:14px;">Trung bình (5-6.5)</span>
                      </div>
                      <div style="display:flex;align-items:center;gap:8px;">
                        <div style="width:16px;height:16px;background:#66bb6a;border-radius:2px;"></div>
                        <span style="color:#2c5530;font-size:14px;">Khá (6.5-8)</span>
                      </div>
                      <div style="display:flex;align-items:center;gap:8px;">
                        <div style="width:16px;height:16px;background:#42a5f5;border-radius:2px;"></div>
                        <span style="color:#2c5530;font-size:14px;">Giỏi (8-10)</span>
                      </div>
                    </div>
                    <canvas id="scoreDistChart" style="max-height:300px;"></canvas>
                  </div>
                  
                  <!-- Subject Comparison Chart Container -->
                  <div id="subject-chart-container" style="display:none;margin-bottom:20px;">
                    <canvas id="subjectChart" style="max-height:300px;"></canvas>
                  </div>
                </div>
              </div>
              
              <!-- Notes Tab -->
              <div id="notes-tab" class="tab-pane">
                <div class="section-header">
                  <h3>Ghi chú</h3>
                  <button class="btn-primary btn-small" id="btn-add-note">
                    <i class="fa-solid fa-plus"></i> Thêm ghi chú
                  </button>
                </div>
                <div id="notes-list">
                  <!-- Notes list will be loaded here -->
                  <div class="no-data">Chưa có ghi chú nào</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal for adding achievement/score -->
  <div id="add-achievement-modal" class="modal hidden">
    <div class="modal-content glass">
      <h3>Thêm thành tích (Điểm số)</h3>
      <select id="achievement-subject" class="input-field" required>
        <option value="">Môn học</option>
        <option value="Toán">Toán</option>
        <option value="Ngữ văn">Ngữ văn</option>
        <option value="Tiếng Anh">Tiếng Anh</option>
        <option value="Vật lý">Vật lý</option>
        <option value="Hóa học">Hóa học</option>
        <option value="Sinh học">Sinh học</option>
        <option value="Lịch sử">Lịch sử</option>
        <option value="Địa lý">Địa lý</option>
        <option value="Thể dục">Thể dục</option>
        <option value="Âm nhạc">Âm nhạc</option>
        <option value="Mỹ thuật">Mỹ thuật</option>
      </select>
      <input type="number" id="achievement-score" placeholder="Điểm (0-10)" class="input-field" min="0" max="10" step="0.1" required>
      <select id="achievement-coefficient" class="input-field" required>
        <option value="">Hệ số</option>
        <option value="1">Hệ số 1</option>
        <option value="2">Hệ số 2</option>
        <option value="3">Hệ số 3</option>
      </select>
      <input type="date" id="achievement-date" class="input-field" required>
      <div class="modal-actions">
        <button id="save-achievement" class="btn-primary">Lưu</button>
        <button id="close-achievement-modal" class="btn-secondary">Đóng</button>
      </div>
    </div>
  </div>

  <!-- Modal for adding conduct -->
  <div id="add-conduct-modal" class="modal hidden">
    <div class="modal-content glass">
      <h3>Thêm đánh giá hạnh kiểm</h3>
      <select id="conduct-type" class="input-field" required>
        <option value="">Loại đánh giá</option>
        <option value="good">Tốt</option>
        <option value="average">Khá</option>
        <option value="poor">Yếu</option>
        <option value="warning">Cảnh cáo</option>
      </select>
      <textarea id="conduct-description" placeholder="Chi tiết đánh giá" class="input-field" rows="4" required></textarea>
      <input type="date" id="conduct-date" class="input-field" required>
      <div class="modal-actions">
        <button id="save-conduct" class="btn-primary">Lưu</button>
        <button id="close-conduct-modal" class="btn-secondary">Đóng</button>
      </div>
    </div>
  </div>

  <!-- Modal for adding note -->
  <div id="add-note-modal" class="modal hidden">
    <div class="modal-content glass">
      <h3>Thêm ghi chú</h3>
      <textarea id="note-content" placeholder="Nội dung ghi chú" class="input-field" rows="6" required></textarea>
      <input type="date" id="note-date" class="input-field" required>
      <div class="modal-actions">
        <button id="save-note" class="btn-primary">Lưu</button>
        <button id="close-note-modal" class="btn-secondary">Đóng</button>
      </div>
    </div>
  </div>

  <script src="https://www.gstatic.com/firebasejs/10.13.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.13.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.13.2/firebase-firestore-compat.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.6.2/axios.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>

  <!-- Firebase Config -->  
  <script src="js/firebase-config.js"></script>
  <script src="js/firebase-init.js"></script>

  <script src="js/particles.js"></script>
  <script src="js/app.js"></script>
  <script src="js/student-detail.js"></script>
  <script src="js/auth.js"></script>
</body>
</html>